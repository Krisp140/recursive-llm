
index 96b6a24d9..71274ac1b 100644
--- a/tldraw_apps_dotcom_client_src_tla_components_TlaEditor_TlaEditor.tsx_expectedoutput.txt (expected):tmp/tmpyd50jyjw_expected.txt	
+++ b/tldraw_apps_dotcom_client_src_tla_components_TlaEditor_TlaEditor.tsx_extracted.txt (actual):tmp/tmp2_yu7v0y_actual.txt	
@@ -1,3 +1,4 @@
+import { TlaFileOpenState } from '@tldraw/dotcom-shared'
 import { useSync } from '@tldraw/sync'
 import { useCallback, useEffect, useMemo } from 'react'
 import {
@@ -155,27 +156,6 @@ function TlaEditorInner({ fileSlug, deepLinks }: TlaEditorProps) {
 		[addDialog, app, fileId, remountImageShapes, setIsReady]
 	)
 
-	const user = useTldrawUser()
-	const getUserToken = useEvent(async () => {
-		return (await user?.getToken()) ?? 'not-logged-in'
-	})
-	const hasUser = !!user
-	const assets = useMemo(() => {
-		return multiplayerAssetStore(() => fileId)
-	}, [fileId])
-
-	const store = useSync({
-		uri: useCallback(async () => {
-			const url = new URL(`${MULTIPLAYER_SERVER}/app/file/${fileSlug}`)
-			if (hasUser) {
-				url.searchParams.set('accessToken', await getUserToken())
-			}
-			return url.toString()
-		}, [fileSlug, hasUser, getUserToken]),
-		assets,
-		userInfo: app?.tlUser.userPreferences,
-	})
-
 	// Handle entering and exiting the file, with some protection against rapid enters/exits
 	useEffect(() => {
 		if (!app) return
@@ -209,6 +189,27 @@ function TlaEditorInner({ fileSlug, deepLinks }: TlaEditorProps) {
 		}
 	}, [app, fileId, store.status])
 
+	const user = useTldrawUser()
+	const getUserToken = useEvent(async () => {
+		return (await user?.getToken()) ?? 'not-logged-in'
+	})
+	const hasUser = !!user
+	const assets = useMemo(() => {
+		return multiplayerAssetStore(() => fileId)
+	}, [fileId])
+
+	const store = useSync({
+		uri: useCallback(async () => {
+			const url = new URL(`${MULTIPLAYER_SERVER}/app/file/${fileSlug}`)
+			if (hasUser) {
+				url.searchParams.set('accessToken', await getUserToken())
+			}
+			return url.toString()
+		}, [fileSlug, hasUser, getUserToken]),
+		assets,
+		userInfo: app?.tlUser.userPreferences,
+	})
+
 	const overrides = useFileEditorOverrides({ fileSlug })
 
 	return (
