
index c9341cb38..8476f78bb 100644
--- a/qdrant_lib_collection_src_shards_local_shard_mod.rs_expectedoutput.txt (expected):tmp/tmpw92hgctm_expected.txt	
+++ b/qdrant_lib_collection_src_shards_local_shard_mod.rs_extracted.txt (actual):tmp/tmp4p_yd8_z_actual.txt	
@@ -65,7 +65,7 @@ use crate::shards::shard::ShardId;
 use crate::shards::shard_config::ShardConfig;
 use crate::update_handler::{Optimizer, UpdateHandler, UpdateSignal};
 use crate::wal::SerdeWal;
-use crate::wal_delta::{LockedWal, RecoverableWal};
+use crate::wal_delta::{LockedWal, RecoverableWal;
 
 /// If rendering WAL load progression in basic text form, report progression every 60 seconds.
 const WAL_LOAD_REPORT_EVERY: Duration = Duration::from_secs(60);
@@ -148,6 +148,7 @@ impl LocalShard {
             remove_dir_all(segments_path).await?;
         }
 
+        // Delete clock maps
         LocalShardClocks::delete_data(shard_path).await?;
 
         Ok(())
@@ -173,15 +174,15 @@ impl LocalShard {
         let optimizers_log = Arc::new(ParkingMutex::new(Default::default()));
         let total_optimized_points = Arc::new(AtomicUsize::new(0));
 
-        // default to 2x the WAL capacity
-        let disk_buffer_threshold_mb =
-            2 * (collection_config.read().await.wal_config.wal_capacity_mb);
-
-        let disk_usage_watcher = disk_usage_watcher::DiskUsageWatcher::new(
-            shard_path.to_owned(),
-            disk_buffer_threshold_mb,
-        )
-        .await;
+        let read_rate_limiter = config
+            .strict_mode_config
+            .as_ref()
+            .and_then(|strict_mode| {
+                strict_mode
+                    .read_rate_limit
+                    .map(RateLimiter::new_per_minute)
+                    .map(ParkingMutex::new)
+            });
 
         let mut update_handler = UpdateHandler::new(
             shared_storage_config.clone(),
@@ -205,13 +206,6 @@ impl LocalShard {
 
         let update_tracker = segment_holder.read().update_tracker();
 
-        let read_rate_limiter = config.strict_mode_config.as_ref().and_then(|strict_mode| {
-            strict_mode
-                .read_rate_limit
-                .map(RateLimiter::new_per_minute)
-                .map(ParkingMutex::new)
-        });
-
         drop(config); // release `shared_config` from borrow checker
 
         Self {
@@ -229,7 +223,7 @@ impl LocalShard {
             optimizers,
             optimizers_log,
             total_optimized_points,
-            disk_usage_watcher,
+            disk_usage_watcher: DiskUsageWatcher::new_default(shard_path).await,
             read_rate_limiter,
         }
     }
@@ -975,13 +969,6 @@ impl LocalShard {
         Ok(())
     }
 
-    pub fn segment_manifests(&self) -> CollectionResult<SegmentManifests> {
-        self.segments()
-            .read()
-            .segment_manifests()
-            .map_err(CollectionError::from)
-    }
-
     pub fn estimate_cardinality<'a>(
         &'a self,
         filter: Option<&'a Filter>,
@@ -1017,6 +1004,13 @@ impl LocalShard {
         SegmentsSearcher::read_filtered(segments, filter, runtime_handle, hw_counter).await
     }
 
+    pub fn segment_manifests(&self) -> CollectionResult<SegmentManifests> {
+        self.segments()
+            .read()
+            .segment_manifests()
+            .map_err(CollectionError::from)
+    }
+
     pub async fn local_shard_status(&self) -> (ShardStatus, OptimizersStatus) {
         {
             let segments = self.segments().read();
