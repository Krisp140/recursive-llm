
index 42fc8b445..57433d007 100644
--- a/aider_aider_coders_editblock_coder.py_expectedoutput.txt (expected):tmp/tmpdxz1qpnp_expected.txt	
+++ b/aider_aider_coders_editblock_coder.py_extracted.txt (actual):tmp/tmpgntz377__actual.txt	
@@ -181,10 +181,6 @@ def replace_most_similar_chunk(whole, part, replace):
         pass
 
     return
-    # Try fuzzy matching
-    res = replace_closest_edit_distance(whole_lines, part, part_lines, replace_lines)
-    if res:
-        return res
 
 
 def try_dotdotdots(whole, part, replace):
@@ -319,12 +315,17 @@ def replace_closest_edit_distance(whole_lines, part, part_lines, replace_lines):
     if max_similarity < similarity_thresh:
         return
 
+    replace_lines = replace.splitlines()
+
     modified_whole = (
         whole_lines[:most_similar_chunk_start]
         + replace_lines
         + whole_lines[most_similar_chunk_end:]
     )
-    modified_whole = "".join(modified_whole)
+    modified_whole = "\n".join(modified_whole)
+
+    if whole.endswith("\n"):
+        modified_whole += "\n"
 
     return modified_whole
 
